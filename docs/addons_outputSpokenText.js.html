<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"><title>addons/outputSpokenText.js - MathLive Docs</title><meta name="description" content="Beautifully typeset math made easy"><meta name="keywords" content="latex, tex, math, typesetting, documentation, docs">

    <meta name="viewport" content="width=device-width, initial-scale=1">


    
        <link rel="stylesheet" href="http://mathlive.io/sprint15/mathlive/mathlive.core.css" type="text/css"><link rel="stylesheet" href="http://mathlive.io/sprint15/mathlive/mathlive.css" type="text/css">
    


    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700|Source+Sans+Pro:400,400i,700,900" rel="stylesheet">
    <style>pre.prettyprint{background: #35434e;}</style>
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow-night.css">

    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/custom.css">
</head>
<body>


<div class="forkme"><a href="https://github.com/arnog/mathlive"><img style="position: absolute; top: 0; right: 0; border: 0; z-index:1;" src="https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"></a></div>


<section role="navigation">
    <input type="checkbox" id="nav-trigger" class="nav-trigger" />
    <label for="nav-trigger" class="navicon-button x">
        <div class="navicon"></div>
    </label>

    <label for="nav-trigger" class="overlay"></label>

    <nav id="nav">
        <h3 class="group-title home"><a href="index.html">MathLive Docs</a></h3><input class="search" placeholder="Search" type="text"><div class="list"><h3 class="group-title">Tutorials</h3><ul><li><a href="tutorial-CONFIG.html">CONFIG</a><ul></ul></li><li><a href="tutorial-CONTRIBUTOR_GUIDE.html">Contributor Guide</a><ul></ul></li><li><a href="tutorial-MASTON.html">MASTON</a><ul></ul></li><li><a href="tutorial-SELECTORS.html">SELECTORS</a><ul></ul></li><li><a href="tutorial-USAGE_GUIDE.html">Usage Guide</a><ul><li><a href="tutorial-EXAMPLES.html">Examples</a></li><li><a href="tutorial-COMMANDS_REFERENCE.html">Commands Reference</a></li></ul></li></ul><h3 class="group-title">Modules</h3><ul><li class="private"><a href="module-color.html" class="className">color</a><ul class='methods private'><li data-type='method' class='private'><a href="module-color.html#.stringToColor" class="methodName">stringToColor</a></li></ul></li><li class="private"><a href="module-definitions.html" class="className">definitions</a><ul class='methods private'><li data-type='method' class='private'><a href="module-definitions.html#.defineEnvironment" class="methodName">defineEnvironment</a></li><li data-type='method' class='private'><a href="module-definitions.html#.defineFunction" class="methodName">defineFunction</a></li><li data-type='method' class='private'><a href="module-definitions.html#.defineSymbol" class="methodName">defineSymbol</a></li><li data-type='method' class='private'><a href="module-definitions.html#.defineSymbolRange" class="methodName">defineSymbolRange</a></li><li data-type='method' class='private'><a href="module-definitions.html#.defineSymbols" class="methodName">defineSymbols</a></li><li data-type='method' class='private'><a href="module-definitions.html#.frequency" class="methodName">frequency</a></li><li data-type='method' class='private'><a href="module-definitions.html#.getInfo" class="methodName">getInfo</a></li><li data-type='method' class='private'><a href="module-definitions.html#.matchCodepoint" class="methodName">matchCodepoint</a></li><li data-type='method' class='private'><a href="module-definitions.html#.matchFunction" class="methodName">matchFunction</a></li><li data-type='method' class='private'><a href="module-definitions.html#.parseParamTemplateArgument" class="methodName">parseParamTemplateArgument</a></li><li data-type='method' class='private'><a href="module-definitions.html#.suggest" class="methodName">suggest</a></li><li data-type='method' class='private'><a href="module-definitions.html#~getSimpleString" class="methodName">getSimpleString</a></li><li data-type='method' class='private'><a href="module-definitions.html#~mathVariantToUnicode" class="methodName">mathVariantToUnicode</a></li></ul></li><li class="private"><a href="module-delimiters.html" class="className">delimiters</a><ul class='methods private'><li data-type='method' class='private'><a href="module-delimiters.html#.makeCustomSizedDelim" class="methodName">makeCustomSizedDelim</a></li><li data-type='method' class='private'><a href="module-delimiters.html#.makeInner" class="methodName">makeInner</a></li><li data-type='method' class='private'><a href="module-delimiters.html#.makeLargeDelim" class="methodName">makeLargeDelim</a></li><li data-type='method' class='private'><a href="module-delimiters.html#.makeLeftRightDelim" class="methodName">makeLeftRightDelim</a></li><li data-type='method' class='private'><a href="module-delimiters.html#.makeNullFence" class="methodName">makeNullFence</a></li><li data-type='method' class='private'><a href="module-delimiters.html#.makeSizedDelim" class="methodName">makeSizedDelim</a></li><li data-type='method' class='private'><a href="module-delimiters.html#.makeSmallDelim" class="methodName">makeSmallDelim</a></li><li data-type='method' class='private'><a href="module-delimiters.html#.makeStackedDelim" class="methodName">makeStackedDelim</a></li><li data-type='method' class='private'><a href="module-delimiters.html#.traverseSequence" class="methodName">traverseSequence</a></li><li data-type='method' class='private'><a href="module-delimiters.html#~delimTypeToFont" class="methodName">delimTypeToFont</a></li></ul></li><li class="private"><a href="module-editor_editableMathlist.html" class="className">editor/editableMathlist</a><ul class='methods private'><li data-type='method' class='private'><a href="module-editor_editableMathlist.html#~arrayCell" class="methodName">arrayCell</a></li><li data-type='method' class='private'><a href="module-editor_editableMathlist.html#~arrayCellCount" class="methodName">arrayCellCount</a></li><li data-type='method' class='private'><a href="module-editor_editableMathlist.html#~arrayColRow" class="methodName">arrayColRow</a></li><li data-type='method' class='private'><a href="module-editor_editableMathlist.html#~arrayIndex" class="methodName">arrayIndex</a></li><li data-type='method' class='private'><a href="module-editor_editableMathlist.html#~atomContains" class="methodName">atomContains</a></li><li data-type='method' class='private'><a href="module-editor_editableMathlist.html#~getString" class="methodName">getString</a></li></ul></li><li class="private"><a href="module-editor_keyboard.html" class="className">editor/keyboard</a><ul class='methods private'><li data-type='method' class='private'><a href="module-editor_keyboard.html#.delegateKeyboardEvents" class="methodName">delegateKeyboardEvents</a></li><li data-type='method' class='private'><a href="module-editor_keyboard.html#.keyboardEventToString" class="methodName">keyboardEventToString</a></li></ul></li><li class="private"><a href="module-editor_mathfield.html" class="className">editor/mathfield</a><ul class='methods private'><li data-type='method' class='private'><a href="module-editor_mathfield.html#nearestElementFromPoint" class="methodName">nearestElementFromPoint</a></li><li data-type='method' class='private'><a href="module-editor_mathfield.html#~_findElementWithCaret" class="methodName">_findElementWithCaret</a></li><li data-type='method' class='private'><a href="module-editor_mathfield.html#~_onAnnounce" class="methodName">_onAnnounce</a></li></ul></li><li class="private"><a href="module-editor_mathpath.html" class="className">editor/mathpath</a><ul class='methods private'><li data-type='method' class='private'><a href="module-editor_mathpath.html#.pathCommonAncestor" class="methodName">pathCommonAncestor</a></li><li data-type='method' class='private'><a href="module-editor_mathpath.html#.pathDistance" class="methodName">pathDistance</a></li><li data-type='method' class='private'><a href="module-editor_mathpath.html#.pathFromString" class="methodName">pathFromString</a></li><li data-type='method' class='private'><a href="module-editor_mathpath.html#.pathToString" class="methodName">pathToString</a></li></ul></li><li class="private"><a href="module-editor_shortcuts.html" class="className">editor/shortcuts</a><ul class='methods private'><li data-type='method' class='private'><a href="module-editor_shortcuts.html#.match" class="methodName">match</a></li><li data-type='method' class='private'><a href="module-editor_shortcuts.html#.matchKeystroke" class="methodName">matchKeystroke</a></li><li data-type='method' class='private'><a href="module-editor_shortcuts.html#.platform" class="methodName">platform</a></li><li data-type='method' class='private'><a href="module-editor_shortcuts.html#.stringify" class="methodName">stringify</a></li></ul></li><li class="private"><a href="module-fontMetrics.html" class="className">fontMetrics</a><ul class='methods private'><li data-type='method' class='private'><a href="module-fontMetrics.html#.getCharacterMetrics" class="methodName">getCharacterMetrics</a></li><li data-type='method' class='private'><a href="module-fontMetrics.html#~convertDimenToEm" class="methodName">convertDimenToEm</a></li></ul></li><li class="private"><a href="module-lexer.html" class="className">lexer</a><ul class='methods private'><li data-type='method' class='private'><a href="module-lexer.html#.tokenize" class="methodName">tokenize</a></li></ul></li><li class="private"><a href="module-mathAtom.html" class="className">mathAtom</a><ul class='methods private'><li data-type='method' class='private'><a href="module-mathAtom.html#.decompose" class="methodName">decompose</a></li><li data-type='method' class='private'><a href="module-mathAtom.html#.getFontName" class="methodName">getFontName</a></li><li data-type='method' class='private'><a href="module-mathAtom.html#.makeColGap" class="methodName">makeColGap</a></li><li data-type='method' class='private'><a href="module-mathAtom.html#.makeColOfRepeatingElements" class="methodName">makeColOfRepeatingElements</a></li><li data-type='method' class='private'><a href="module-mathAtom.html#.makeStack" class="methodName">makeStack</a></li></ul></li><li><a href="module-mathlive.html" class="className">mathlive</a><ul class='methods'><li data-type='method'><a href="module-mathlive.html#latexToAST" class="methodName">latexToAST</a></li><li data-type='method'><a href="module-mathlive.html#latexToMarkup" class="methodName">latexToMarkup</a></li><li data-type='method'><a href="module-mathlive.html#latexToMathML" class="methodName">latexToMathML</a></li><li data-type='method'><a href="module-mathlive.html#makeMathField" class="methodName">makeMathField</a></li><li data-type='method'><a href="module-mathlive.html#pauseReadAloud" class="methodName">pauseReadAloud</a></li><li data-type='method'><a href="module-mathlive.html#playReadAloud" class="methodName">playReadAloud</a></li><li data-type='method'><a href="module-mathlive.html#readAloud" class="methodName">readAloud</a></li><li data-type='method'><a href="module-mathlive.html#readAloudStatus" class="methodName">readAloudStatus</a></li><li data-type='method'><a href="module-mathlive.html#renderMathInDocument" class="methodName">renderMathInDocument</a></li><li data-type='method'><a href="module-mathlive.html#renderMathInElement" class="methodName">renderMathInElement</a></li><li data-type='method'><a href="module-mathlive.html#resumeReadAloud" class="methodName">resumeReadAloud</a></li><li data-type='method'><a href="module-mathlive.html#revertToOriginalContent" class="methodName">revertToOriginalContent</a></li><li data-type='method'><a href="module-mathlive.html#revertToOriginalContent" class="methodName">revertToOriginalContent</a></li><li data-type='method'><a href="module-mathlive.html#~highlightAtomID" class="methodName">highlightAtomID</a></li></ul></li><li class="private"><a href="module-mathstyle.html" class="className">mathstyle</a><ul class='methods private'><li data-type='method' class='private'><a href="module-mathstyle.html#.toMathstyle" class="methodName">toMathstyle</a></li></ul></li><li class="private"><a href="module-span.html" class="className">span</a><ul class='methods private'><li data-type='method' class='private'><a href="module-span.html#.coalesce" class="methodName">coalesce</a></li><li data-type='method' class='private'><a href="module-span.html#.makeFontSizer" class="methodName">makeFontSizer</a></li><li data-type='method' class='private'><a href="module-span.html#.makeHlist" class="methodName">makeHlist</a></li><li data-type='method' class='private'><a href="module-span.html#.makeSpan" class="methodName">makeSpan</a></li><li data-type='method' class='private'><a href="module-span.html#.makeSpanOfType" class="methodName">makeSpanOfType</a></li><li data-type='method' class='private'><a href="module-span.html#.makeSymbol" class="methodName">makeSymbol</a></li><li data-type='method' class='private'><a href="module-span.html#.makeVlist" class="methodName">makeVlist</a></li><li data-type='method' class='private'><a href="module-span.html#.toString" class="methodName">toString</a></li><li data-type='method' class='private'><a href="module-span.html#~makeSVG" class="methodName">makeSVG</a></li></ul></li></ul><h3 class="group-title">Classes</h3><ul><li class="private"><a href="Context.html" class="className">Context</a><ul class='methods private'><li data-type='method' class='private'><a href="Context.html#clone" class="methodName">clone</a></li><li data-type='method' class='private'><a href="Context.html#cloneWith" class="methodName">cloneWith</a></li><li data-type='method' class='private'><a href="Context.html#getBackgroundColor" class="methodName">getBackgroundColor</a></li><li data-type='method' class='private'><a href="Context.html#getColor" class="methodName">getColor</a></li><li data-type='method' class='private'><a href="Context.html#setMathstyle" class="methodName">setMathstyle</a></li><li data-type='method' class='private'><a href="Context.html#withMathstyle" class="methodName">withMathstyle</a></li></ul></li><li><a href="EditableMathlist.html" class="className">EditableMathlist</a><ul class='methods'><li data-type='method'><a href="EditableMathlist.html#_addCell" class="methodName">_addCell</a></li><li data-type='method'><a href="EditableMathlist.html#_deleteAtoms" class="methodName">_deleteAtoms</a></li><li data-type='method'><a href="EditableMathlist.html#addColumnAfter_" class="methodName">addColumnAfter_</a></li><li data-type='method'><a href="EditableMathlist.html#addColumnBefore_" class="methodName">addColumnBefore_</a></li><li data-type='method'><a href="EditableMathlist.html#addRowAfter_" class="methodName">addRowAfter_</a></li><li data-type='method'><a href="EditableMathlist.html#addRowBefore_" class="methodName">addRowBefore_</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#ancestor" class="methodName">ancestor</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#anchor" class="methodName">anchor</a></li><li data-type='method'><a href="EditableMathlist.html#applyStyle" class="methodName">applyStyle</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#commandOffsets" class="methodName">commandOffsets</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#commitCommandStringBeforeInsertionPoint" class="methodName">commitCommandStringBeforeInsertionPoint</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#contains" class="methodName">contains</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#decorateCommandStringAroundInsertionPoint" class="methodName">decorateCommandStringAroundInsertionPoint</a></li><li data-type='method'><a href="EditableMathlist.html#delete" class="methodName">delete</a></li><li data-type='method'><a href="EditableMathlist.html#delete_" class="methodName">delete_</a></li><li data-type='method'><a href="EditableMathlist.html#deleteAll_" class="methodName">deleteAll_</a></li><li data-type='method'><a href="EditableMathlist.html#deleteNextChar_" class="methodName">deleteNextChar_</a></li><li data-type='method'><a href="EditableMathlist.html#deleteNextWord_" class="methodName">deleteNextWord_</a></li><li data-type='method'><a href="EditableMathlist.html#deletePreviousChar_" class="methodName">deletePreviousChar_</a></li><li data-type='method'><a href="EditableMathlist.html#deletePreviousWord_" class="methodName">deletePreviousWord_</a></li><li data-type='method'><a href="EditableMathlist.html#deleteToGroupEnd_" class="methodName">deleteToGroupEnd_</a></li><li data-type='method'><a href="EditableMathlist.html#deleteToGroupStart_" class="methodName">deleteToGroupStart_</a></li><li data-type='method'><a href="EditableMathlist.html#deleteToMathFieldEnd_" class="methodName">deleteToMathFieldEnd_</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#endOffset" class="methodName">endOffset</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#extend" class="methodName">extend</a></li><li data-type='method'><a href="EditableMathlist.html#extendDown_" class="methodName">extendDown_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToGroupEnd_" class="methodName">extendToGroupEnd_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToGroupStart_" class="methodName">extendToGroupStart_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToMathFieldEnd_" class="methodName">extendToMathFieldEnd_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToMathFieldStart_" class="methodName">extendToMathFieldStart_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToNextBoundary_" class="methodName">extendToNextBoundary_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToNextChar_" class="methodName">extendToNextChar_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToNextWord_" class="methodName">extendToNextWord_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToPreviousBoundary_" class="methodName">extendToPreviousBoundary_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToPreviousChar_" class="methodName">extendToPreviousChar_</a></li><li data-type='method'><a href="EditableMathlist.html#extendToPreviousWord_" class="methodName">extendToPreviousWord_</a></li><li data-type='method'><a href="EditableMathlist.html#extendUp_" class="methodName">extendUp_</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#extractCharactersBeforeInsertionPoint" class="methodName">extractCharactersBeforeInsertionPoint</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#extractCommandStringAroundInsertionPoint" class="methodName">extractCommandStringAroundInsertionPoint</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#extractContents" class="methodName">extractContents</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#extractContentsOrdInGroupBeforeInsertionPoint" class="methodName">extractContentsOrdInGroupBeforeInsertionPoint</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#filter" class="methodName">filter</a></li><li data-type='method'><a href="EditableMathlist.html#insert" class="methodName">insert</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#insertFirstAtom" class="methodName">insertFirstAtom</a></li><li data-type='method'><a href="EditableMathlist.html#isCollapsed" class="methodName">isCollapsed</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#jump" class="methodName">jump</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#leap" class="methodName">leap</a></li><li data-type='method'><a href="EditableMathlist.html#moveAfterParent_" class="methodName">moveAfterParent_</a></li><li data-type='method'><a href="EditableMathlist.html#moveBeforeParent_" class="methodName">moveBeforeParent_</a></li><li data-type='method'><a href="EditableMathlist.html#moveDown_" class="methodName">moveDown_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToGroupEnd_" class="methodName">moveToGroupEnd_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToGroupStart_" class="methodName">moveToGroupStart_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToMathFieldEnd_" class="methodName">moveToMathFieldEnd_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToMathFieldStart_" class="methodName">moveToMathFieldStart_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToNextChar_" class="methodName">moveToNextChar_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToNextPlaceholder_" class="methodName">moveToNextPlaceholder_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToNextWord_" class="methodName">moveToNextWord_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToOpposite_" class="methodName">moveToOpposite_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToPreviousChar_" class="methodName">moveToPreviousChar_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToPreviousPlaceholder_" class="methodName">moveToPreviousPlaceholder_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToPreviousWord_" class="methodName">moveToPreviousWord_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToSubscript_" class="methodName">moveToSubscript_</a></li><li data-type='method'><a href="EditableMathlist.html#moveToSuperscript_" class="methodName">moveToSuperscript_</a></li><li data-type='method'><a href="EditableMathlist.html#moveUp_" class="methodName">moveUp_</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#next" class="methodName">next</a></li><li data-type='method'><a href="EditableMathlist.html#selectAll_" class="methodName">selectAll_</a></li><li data-type='method'><a href="EditableMathlist.html#selectGroup_" class="methodName">selectGroup_</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#setExtent" class="methodName">setExtent</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#setRange" class="methodName">setRange</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#setSelection" class="methodName">setSelection</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#sibling" class="methodName">sibling</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#siblings" class="methodName">siblings</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#skip" class="methodName">skip</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#startOffset" class="methodName">startOffset</a></li><li data-type='method' class='private'><a href="EditableMathlist.html#toString" class="methodName">toString</a></li><li data-type='method'><a href="EditableMathlist.html#transpose_" class="methodName">transpose_</a></li></ul></li><li class="private"><a href="Lexer.html" class="className">Lexer</a><ul class='methods private'><li data-type='method' class='private'><a href="Lexer.html#end" class="methodName">end</a></li><li data-type='method' class='private'><a href="Lexer.html#get" class="methodName">get</a></li><li data-type='method' class='private'><a href="Lexer.html#isWhiteSpace" class="methodName">isWhiteSpace</a></li><li data-type='method' class='private'><a href="Lexer.html#makeToken" class="methodName">makeToken</a></li><li data-type='method' class='private'><a href="Lexer.html#peek" class="methodName">peek</a></li><li data-type='method' class='private'><a href="Lexer.html#scan" class="methodName">scan</a></li></ul></li><li class="private"><a href="MathAtom.html" class="className">MathAtom</a><ul class='methods private'><li data-type='method' class='private'><a href="MathAtom.html#.toSpeakableText" class="methodName">toSpeakableText</a></li><li data-type='method' class='private'><a href="MathAtom.html#bind" class="methodName">bind</a></li><li data-type='method' class='private'><a href="MathAtom.html#decompose" class="methodName">decompose</a></li><li data-type='method' class='private'><a href="MathAtom.html#decomposeGenfrac" class="methodName">decomposeGenfrac</a></li><li data-type='method' class='private'><a href="MathAtom.html#decomposeLeftright" class="methodName">decomposeLeftright</a></li><li data-type='method' class='private'><a href="MathAtom.html#decomposeLine" class="methodName">decomposeLine</a></li><li data-type='method' class='private'><a href="MathAtom.html#decomposeRule" class="methodName">decomposeRule</a></li><li data-type='method' class='private'><a href="MathAtom.html#filter" class="methodName">filter</a></li><li data-type='method' class='private'><a href="MathAtom.html#makeSpan" class="methodName">makeSpan</a></li></ul></li><li><a href="MathField.html" class="className">MathField</a><ul class='methods'><li data-type='method'><a href="MathField.html#$el" class="methodName">$el</a></li><li data-type='method'><a href="MathField.html#$insert" class="methodName">$insert</a></li><li data-type='method'><a href="MathField.html#$keystroke" class="methodName">$keystroke</a></li><li data-type='method'><a href="MathField.html#$latex" class="methodName">$latex</a></li><li data-type='method'><a href="MathField.html#$perform" class="methodName">$perform</a></li><li data-type='method'><a href="MathField.html#$revertToOriginalContent" class="methodName">$revertToOriginalContent</a></li><li data-type='method'><a href="MathField.html#$selectedText" class="methodName">$selectedText</a></li><li data-type='method'><a href="MathField.html#$selectionAtStart" class="methodName">$selectionAtStart</a></li><li data-type='method'><a href="MathField.html#$selectionDepth" class="methodName">$selectionDepth</a></li><li data-type='method'><a href="MathField.html#$selectionIsCollapsed" class="methodName">$selectionIsCollapsed</a></li><li data-type='method'><a href="MathField.html#$setConfig" class="methodName">$setConfig</a></li><li data-type='method'><a href="MathField.html#$text" class="methodName">$text</a></li><li data-type='method'><a href="MathField.html#$typedText" class="methodName">$typedText</a></li><li data-type='method' class='private'><a href="MathField.html#_getCaretPosition" class="methodName">_getCaretPosition</a></li><li data-type='method' class='private'><a href="MathField.html#_onKeystroke" class="methodName">_onKeystroke</a></li><li data-type='method' class='private'><a href="MathField.html#complete_" class="methodName">complete_</a></li><li data-type='method' class='private'><a href="MathField.html#enterCommandMode_" class="methodName">enterCommandMode_</a></li><li data-type='method' class='private'><a href="MathField.html#render" class="methodName">render</a></li><li data-type='method'><a href="MathField.html#selectionAtEnd" class="methodName">selectionAtEnd</a></li><li data-type='method'><a href="MathField.html#speakAll_" class="methodName">speakAll_</a></li><li data-type='method'><a href="MathField.html#speakAllWithSynchronizedHighlighting_" class="methodName">speakAllWithSynchronizedHighlighting_</a></li><li data-type='method'><a href="MathField.html#speakGroup_" class="methodName">speakGroup_</a></li><li data-type='method'><a href="MathField.html#speakLeftSibling_" class="methodName">speakLeftSibling_</a></li><li data-type='method'><a href="MathField.html#speakParent_" class="methodName">speakParent_</a></li><li data-type='method'><a href="MathField.html#speakRightSibling_" class="methodName">speakRightSibling_</a></li><li data-type='method'><a href="MathField.html#speakSelection_" class="methodName">speakSelection_</a></li><li data-type='method'><a href="MathField.html#speakSelectionWithSynchronizedHighlighting_" class="methodName">speakSelectionWithSynchronizedHighlighting_</a></li></ul></li><li class="private"><a href="module-mathstyle.Mathstyle.html" class="className">Mathstyle</a></li><li class="private"><a href="Parser.html" class="className">Parser</a><ul class='methods private'><li data-type='method' class='private'><a href="Parser.html#end" class="methodName">end</a></li><li data-type='method' class='private'><a href="Parser.html#hasLiteral" class="methodName">hasLiteral</a></li><li data-type='method' class='private'><a href="Parser.html#hasLiteralPattern" class="methodName">hasLiteralPattern</a></li><li data-type='method' class='private'><a href="Parser.html#hasToken" class="methodName">hasToken</a></li><li data-type='method' class='private'><a href="Parser.html#lastMathAtom" class="methodName">lastMathAtom</a></li><li data-type='method' class='private'><a href="Parser.html#parseAtom" class="methodName">parseAtom</a></li><li data-type='method' class='private'><a href="Parser.html#parseKeyword" class="methodName">parseKeyword</a></li><li data-type='method' class='private'><a href="Parser.html#parseLimits" class="methodName">parseLimits</a></li><li data-type='method' class='private'><a href="Parser.html#parseSupSub" class="methodName">parseSupSub</a></li><li data-type='method' class='private'><a href="Parser.html#parseToken" class="methodName">parseToken</a></li><li data-type='method' class='private'><a href="Parser.html#placeholder" class="methodName">placeholder</a></li><li data-type='method' class='private'><a href="Parser.html#scanArg" class="methodName">scanArg</a></li><li data-type='method' class='private'><a href="Parser.html#scanColor" class="methodName">scanColor</a></li><li data-type='method' class='private'><a href="Parser.html#scanDelim" class="methodName">scanDelim</a></li><li data-type='method' class='private'><a href="Parser.html#scanDimen" class="methodName">scanDimen</a></li><li data-type='method' class='private'><a href="Parser.html#scanEnvironment" class="methodName">scanEnvironment</a></li><li data-type='method' class='private'><a href="Parser.html#scanGroup" class="methodName">scanGroup</a></li><li data-type='method' class='private'><a href="Parser.html#scanImplicitGroup" class="methodName">scanImplicitGroup</a></li><li data-type='method' class='private'><a href="Parser.html#scanLeftRight" class="methodName">scanLeftRight</a></li><li data-type='method' class='private'><a href="Parser.html#scanMacro" class="methodName">scanMacro</a></li><li data-type='method' class='private'><a href="Parser.html#scanModeSet" class="methodName">scanModeSet</a></li><li data-type='method' class='private'><a href="Parser.html#scanModeShift" class="methodName">scanModeShift</a></li><li data-type='method' class='private'><a href="Parser.html#scanNumber" class="methodName">scanNumber</a></li><li data-type='method' class='private'><a href="Parser.html#scanString" class="methodName">scanString</a></li><li data-type='method' class='private'><a href="Parser.html#scanToken" class="methodName">scanToken</a></li></ul></li><li class="private"><a href="Span.html" class="className">Span</a></li><li class="private"><a href="Token.html" class="className">Token</a></li><li class="private"><a href="UndoManager.html" class="className">UndoManager</a><ul class='methods private'><li data-type='method' class='private'><a href="UndoManager.html#canRedo" class="methodName">canRedo</a></li><li data-type='method' class='private'><a href="UndoManager.html#canUndo" class="methodName">canUndo</a></li><li data-type='method' class='private'><a href="UndoManager.html#redo" class="methodName">redo</a></li><li data-type='method' class='private'><a href="UndoManager.html#restore" class="methodName">restore</a></li><li data-type='method' class='private'><a href="UndoManager.html#save" class="methodName">save</a></li><li data-type='method' class='private'><a href="UndoManager.html#snapshot" class="methodName">snapshot</a></li><li data-type='method' class='private'><a href="UndoManager.html#undo" class="methodName">undo</a></li></ul></li></ul><h3>Globals</h3><ul><li><a href="global.html#asLatex">asLatex</a></li><li><a href="global.html#asMachineNumber">asMachineNumber</a></li><li><a href="global.html#asSymbol">asSymbol</a></li><li><a href="global.html#escapeText">escapeText</a></li><li><a href="global.html#expandLayerMarkup">expandLayerMarkup</a></li><li><a href="global.html#formatMantissa">formatMantissa</a></li><li><a href="global.html#getCanonicalName">getCanonicalName</a></li><li><a href="global.html#getLatexForSymbol">getLatexForSymbol</a></li><li><a href="global.html#getLatexTemplateForFunction">getLatexTemplateForFunction</a></li><li><a href="global.html#getLatexTemplateForOperator">getLatexTemplateForOperator</a></li><li><a href="global.html#getPrecedence">getPrecedence</a></li><li><a href="global.html#getSymbol">getSymbol</a></li><li><a href="global.html#getType">getType</a></li><li><a href="global.html#isAtom">isAtom</a></li><li><a href="global.html#isSuperscriptAtom">isSuperscriptAtom</a></li><li><a href="global.html#latexify">latexify</a></li><li><a href="global.html#make">make</a></li><li><a href="global.html#makeKeyboardToolbar">makeKeyboardToolbar</a></li><li><a href="global.html#negate">negate</a></li><li><a href="global.html#numberAsLatex">numberAsLatex</a></li><li><a href="global.html#opPrec">opPrec</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#parseDelim">parseDelim</a></li><li><a href="global.html#parseDigraph">parseDigraph</a></li><li><a href="global.html#parseExpression">parseExpression</a></li><li><a href="global.html#parsePostfix">parsePostfix</a></li><li><a href="global.html#parseSupsub">parseSupsub</a></li><li><a href="global.html#parseTokens">parseTokens</a></li><li><a href="global.html#toMathML">toMathML</a></li><li><a href="global.html#validateFence">validateFence</a></li></ul><div class="checkbox"><input id="toggle-private" type="checkbox" onclick="
if (!document.getElementById('toggle-private').checked) {
document.documentElement.classList.add('no-private')
writeCookie('symbol-access', 'no-private')
} else {
document.documentElement.classList.remove('no-private')
writeCookie('symbol-access', 'private')
}
"><label for="toggle-private">Include Private Symbols</label></div></div>
        <footer role="contentInfo">
            Made with <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>. 
            
        </footer>
    </nav>
</section>

<main id="main">
    
        <h1 class="page-title">addons/outputSpokenText.js</h1>
    

    



    
    <section class="source">
        <article>
            <pre class="prettyprint source linenums">
            
            <code>import MathAtom from '../core/mathAtom.js';
import Popover from '../editor/editor-popover.js';
import '../core/definitions.js';

// Markup
// Two common flavor of markups: SSML and 'mac'. The latter is only available
// when using the native TTS synthesizer on Mac OS.
// Use SSML in the production rules below. The markup will either be striped
// off or replaced with the 'mac' markup as necessary.
//
// SSML                                             Mac
// ----                                             ----
// &lt;emphasis>WORD&lt;/emphasis>                        [[emph +]]WORD
// &lt;break time="150ms"/>                            [[slc 150]]
// &lt;say-as interpret-as="character">A&lt;/say-as>      [[char LTRL] A [[char NORM]]

// https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/SpeechSynthesisProgrammingGuide/FineTuning/FineTuning.html#//apple_ref/doc/uid/TP40004365-CH5-SW3

// https://pdfs.semanticscholar.org/8887/25b82b8dbb45dd4dd69b36a65f092864adb0.pdf

// "&lt;audio src='non_existing_file.au'>File could not be played.&lt;/audio>"

// "I am now &lt;prosody rate='+0.06'>speaking 6% faster.&lt;/prosody>"



const PRONUNCIATION = {
    '\\alpha':      ' alpha ',
    '\\mu':         ' mew ',
    '\\sigma':      ' sigma ',
    '\\pi':         ' pie ',
    '\\imaginaryI': ' eye ',

    '\\sum':        ' Summation ',
    '\\prod':       ' Product ',


    ';':            ' &lt;break time="150ms"/> semi-colon &lt;break time="150ms"/>',
    ',':            ' &lt;break time="150ms"/> comma  &lt;break time="150ms"/>',
    '|':            ' &lt;break time="150ms"/>Vertical bar&lt;break time="150ms"/>',
    '(':            ' &lt;break time="150ms"/>Open paren. &lt;break time="150ms"/>',
    ')':            '. &lt;break time="150ms"/> Close paren. &lt;break time="150ms"/>',
    '=':            ' equals ',
    '&lt;':            ' is less than ',
    '\\lt':         ' is less than ',
    '&lt;=':           ' is less than or equal to ',
    '\\le':         ' is less than or equal to ',
    '\\gt':         ' is greater than ',
    '>':            ' is greater than ',
    '\\ge':         ' is greater than or equal to ',
    '\\geq':        ' is greater than or equal to ',
    '\\leq':        ' is less than or equal to ',
    '!':            ' factorial ',
    '\\sin':        ' sine ',
    '\\cos':        ' cosine ',
    '\u200b':       '',
    '\u2212':       ' minus ',
    ':':            ' &lt;break time="150ms"/> such that &lt;break time="200ms"/> ',
    '\\colon':      ' &lt;break time="150ms"/> such that &lt;break time="200ms"/> ',
    '\\hbar':       ' etch bar ',
    '\\iff':        ' &lt;break time="200ms"/>if, and only if, &lt;break time="200ms"/>',
    '\\Longleftrightarrow': '&lt;break time="200ms"/>if, and only if, &lt;break time="200ms"/>',
    '\\land':       ' and ',
    '\\lor':        ' or ',
    '\\neg':        ' not ',
    '\\div':        ' divided by ',

    '\\forall':     ' for all ',
    '\\exists':     ' there exists ',
    '\\nexists':    ' there does not exists ',

    '\\in':         ' element of ',

    '\\N':          ' the set &lt;break time="150ms"/>&lt;say-as interpret-as="character">n&lt;/say-as>',
    '\\C':          ' the set &lt;break time="150ms"/>&lt;say-as interpret-as="character">c&lt;/say-as>',
    '\\Z':          ' the set &lt;break time="150ms"/>&lt;say-as interpret-as="character">z&lt;/say-as>',
    '\\Q':          ' the set &lt;break time="150ms"/>&lt;say-as interpret-as="character">q&lt;/say-as>',

    '\\infty':      ' infinity ',

    '\\nabla':      ' nabla ',

    '\\partial':    ' partial derivative of ',

    '\\cdots':      ' dot dot dot ',

    '\\Rightarrow': ' implies ',

    '\\lbrace':		'&lt;break time="150ms"/>open brace&lt;break time="150ms"/>',
    '\\{':		    '&lt;break time="150ms"/>open brace&lt;break time="150ms"/>',
    '\\rbrace':		'&lt;break time="150ms"/>close brace&lt;break time="150ms"/>',
    '\\}':		    '&lt;break time="150ms"/>close brace&lt;break time="150ms"/>',
    '\\langle':		'&lt;break time="150ms"/>left angle bracket&lt;break time="150ms"/>',
    '\\rangle':		'&lt;break time="150ms"/>right angle bracket&lt;break time="150ms"/>',
    '\\lfloor':		'&lt;break time="150ms"/>open floor&lt;break time="150ms"/>',
    '\\rfloor':		'&lt;break time="150ms"/>close floor&lt;break time="150ms"/>',
    '\\lceil':		'&lt;break time="150ms"/>open ceiling&lt;break time="150ms"/>',
    '\\rceil':		'&lt;break time="150ms"/>close ceiling&lt;break time="150ms"/>',
    '\\vert':		'&lt;break time="150ms"/>vertical bar&lt;break time="150ms"/>',
    '\\mvert':		'&lt;break time="150ms"/>divides&lt;break time="150ms"/>',
    '\\lvert':		'&lt;break time="150ms"/>left vertical bar&lt;break time="150ms"/>',
    '\\rvert':		'&lt;break time="150ms"/>right vertical bar&lt;break time="150ms"/>',
    // '\\lbrack':		'left bracket',
    // '\\rbrack':		'right bracket',
    '\\lbrack':     ' &lt;break time="150ms"/> open square bracket &lt;break time="150ms"/>',
    '\\rbrack':     ' &lt;break time="150ms"/> close square bracket &lt;break time="150ms"/>',
}


function getSpokenName(latex) {
    let result = Popover.NOTES[latex];
    if (!result &amp;&amp; latex.charAt(0) === '\\') {
        result = ' ' + latex.replace('\\', '') + ' ';
    }

    // If we got more than one result (from NOTES),
    // pick the first one.
    if (Array.isArray(result)) {
        result = result[0];
    }

    return result;
}


function platform(p) {
    let result = 'other';
    if (navigator &amp;&amp; navigator.platform &amp;&amp; navigator.userAgent) {
        if (/^(mac)/i.test(navigator.platform)) {
            result = 'mac';
        } else if (/^(win)/i.test(navigator.platform)) {
            result = 'win';
        } else if (/(android)/i.test(navigator.userAgent)) {
            result = 'android';
        } else if (/(iphone)/i.test(navigator.userAgent) ||
                    /(ipod)/i.test(navigator.userAgent) ||
                    /(ipad)/i.test(navigator.userAgent)) {
            result = 'ios';
        } else if (/\bCrOS\b/i.test(navigator.userAgent)) {
            result = 'chromeos';
        }
    }

    return result === p ? p : '!' + p;
}


function isAtomic(mathlist) {
    let count = 0;
    if (mathlist &amp;&amp; Array.isArray(mathlist)) {
        for (const atom of mathlist) {
            if (atom.type !== 'first') {
                count += 1;
            }
        }
    }
    return count === 1;
}

function atomicID(mathlist) {
    if (mathlist &amp;&amp; Array.isArray(mathlist)) {
        for (const atom of mathlist) {
            if (atom.type !== 'first' &amp;&amp; atom.id) {
                return atom.id.toString();
            }
        }
    }
    return '';
}

function atomicValue(mathlist) {
    let result = '';
    if (mathlist &amp;&amp; Array.isArray(mathlist)) {
        for (const atom of mathlist) {
            if (atom.type !== 'first' &amp;&amp; typeof atom.body === 'string') {
                result += atom.body;
            }
        }
    }
    return result;
}





MathAtom.toSpeakableFragment = function(atom, options) {
    function letter(c) {
        let result = '';
        if (!options.textToSpeechMarkup) {
            if (/[a-z]/.test(c)) {
                result += " '" + c.toUpperCase() + "'";
            } else if (/[A-Z]/.test(c)) {
                result += " 'capital " + c.toUpperCase() + "'";
            } else {
                result += c;
            }
        } else {
            if (/[a-z]/.test(c)) {
                result += ' &lt;say-as interpret-as="character">' + c + '&lt;/say-as>';
            } else if (/[A-Z]/.test(c)) {
                result += 'capital ' + c.toLowerCase() + '';
            } else {
                result += c;
            }
        }
        return result;
    }

    function emph(s) {
        return '&lt;emphasis>' + s + '&lt;/emphasis>';
    }

    if (!atom) return '';

    let result = '';

    if (atom.id &amp;&amp; options.speechMode === 'math') {
        result += '&lt;mark name="' + atom.id.toString() + '"/>';
    }

    if (Array.isArray(atom)) {
        let isInDigitRun = false;             // need to group sequence of digits
        for (let i = 0; i &lt; atom.length; i++) {
            if (i &lt; atom.length - 2 &amp;&amp;
                atom[i].type === 'mopen' &amp;&amp;
                atom[i + 2].type === 'mclose' &amp;&amp;
                atom[i + 1].type === 'mord') {
                result += ' of ';
                result += emph(MathAtom.toSpeakableFragment(atom[i + 1], options));
                i += 2;
            // '.' and ',' should only be allowed if prev/next entry is a digit
            // However, if that isn't the case, this still works because 'toSpeakableFragment' is called in either case.
            } else if (atom[i].type === 'mord' &amp;&amp; /[0123456789,.]/.test(atom[i].latex)) {
                if (isInDigitRun) {
                    result += atom[i].latex;
                } else {
                    isInDigitRun = true;
                    result += MathAtom.toSpeakableFragment(atom[i], options);
                }
            } else {
                isInDigitRun = false
                result += MathAtom.toSpeakableFragment(atom[i], options);
            }
        }
    } else {
        let numer = '';
        let denom = '';
        let body = '';
        let supsubHandled = false;
        switch(atom.type) {
            case 'group':
            case 'root':
                result += MathAtom.toSpeakableFragment(atom.body, options);
                break;

            case 'genfrac':
                numer = MathAtom.toSpeakableFragment(atom.numer, options);
                denom = MathAtom.toSpeakableFragment(atom.denom, options);
                if (isAtomic(atom.numer) &amp;&amp; isAtomic(atom.denom)) {
                    const COMMON_FRACTIONS = {
                        '1/2':      ' half ',
                        '1/3':      ' one third ',
                        '2/3':      ' two third',
                        '1/4':      ' one quarter ',
                        '3/4':      ' three quarter ',
                        '1/5':      ' one fifth ',
                        '2/5':      ' two fifths ',
                        '3/5':      ' three fifths ',
                        '4/5':      ' four fifths ',
                        '1/6':      ' one sixth ',
                        '5/6':      ' five sixths ',
                        '1/8':      ' one eight ',
                        '3/8':      ' three eights ',
                        '5/8':      ' five eights ',
                        '7/8':      ' seven eights ',
                        '1/9':      ' one ninth ',
                        '2/9':      ' two ninths ',
                        '4/9':      ' four ninths ',
                        '5/9':      ' five ninths ',
                        '7/9':      ' seven ninths ',
                        '8/9':      ' eight ninths ',
                        // '1/10':     ' one tenth ',
                        // '1/12':     ' one twelfth ',
                        // 'x/2':     ' &lt;say-as interpret-as="character">X&lt;/say-as> over 2',
                    };
                    const commonFraction = COMMON_FRACTIONS[
                        atomicValue(atom.numer) + '/' + atomicValue(atom.denom)];
                    if (commonFraction) {
                        result = commonFraction;
                    } else {
                        result += numer + ' over ' + denom;
                    }
                } else {
                    result += ' the fraction &lt;break time="150ms"/>' + numer + ', over &lt;break time="150ms"/>' + denom + '.&lt;break time="150ms"/> End fraction.&lt;break time="150ms"/>';
                }

                break;
            case 'surd':
                body = MathAtom.toSpeakableFragment(atom.body, options);

                if (!atom.index) {
                    if (isAtomic(atom.body)) {
                        result += ' the square root of ' + body + ' , ';
                    } else {
                        result += ' the square root of &lt;break time="200ms"/>' + body + '. &lt;break time="200ms"/> End square root';
                    }
                } else {
                    let index = MathAtom.toSpeakableFragment(atom.index, options);
                    index = index.trim();
                    const index2 = index.replace(/&lt;mark([^/]*)\/>/g, '')
                    if (index2 === '3') {
                        result += ' the cube root of &lt;break time="200ms"/>' + body + '. &lt;break time="200ms"/> End cube root';
                    } else if (index2 === 'n') {
                        result += ' the nth root of &lt;break time="200ms"/>' + body + '. &lt;break time="200ms"/> End root';
                    } else {
                        result += ' the root with index: &lt;break time="200ms"/>' + index + ', of &lt;break time="200ms"/>' + body + '. &lt;break time="200ms"/> End root';
                    }
                }
                break;
            case 'accent':
                break;
            case 'leftright':
                result += PRONUNCIATION[atom.leftDelim] || atom.leftDelim;
                result += MathAtom.toSpeakableFragment(atom.body, options);
                result += PRONUNCIATION[atom.rightDelim] || atom.rightDelim;
                break;
            case 'line':
                // @todo
                break;
            case 'rule':
                // @todo
                break;
            case 'overunder':
                // @todo
                break;
            case 'overlap':
                // @todo
                break;
            case 'placeholder':
                result += 'placeholder ' + atom.body;
                break;
            case 'delim':
            case 'sizeddelim':
            case 'mord':
            case 'minner':
            case 'mbin':
            case 'mrel':
            case 'mpunct':
            case 'mopen':
            case 'mclose':
            case 'textord':
            {
                const command = atom.latex ? atom.latex.trim() : '' ;
                if (command === '\\mathbin' || command === '\\mathrel' ||
                    command === '\\mathopen' || command === '\\mathclose' ||
                    command === '\\mathpunct' || command === '\\mathord' ||
                    command === '\\mathinner') {
                    result = MathAtom.toSpeakableFragment(atom.body, options);
                    break;
                }

                let atomValue = atom.body;
                let latexValue = atom.latex;
                if (atom.type === 'delim' || atom.type === 'sizeddelim') {
                    atomValue = latexValue = atom.delim;
                }
                if (options.speechMode === 'text') {
                    result += atomValue;
                } else {
                    if (atom.type === 'mbin') {
                        result += '&lt;break time="150ms"/>';
                    }

                    if (atomValue) {
                        const value = PRONUNCIATION[atomValue] ||
                            (latexValue ? PRONUNCIATION[latexValue.trim()] : '');
                        if (value) {
                            result += ' ' + value;
                        } else {
                            const spokenName = latexValue ?
                                getSpokenName(latexValue.trim()) : '';

                            result += spokenName ? spokenName : letter(atomValue);
                        }
                    } else {
                        result += MathAtom.toSpeakableFragment(atom.body, options);
                    }
                    if (atom.type === 'mbin') {
                        result += '&lt;break time="150ms"/>';
                    }
                }
                break;
            }
            case 'mop':
            // @todo
                if (atom.body !== '\u200b') {
                    // Not ZERO-WIDTH
                    const trimLatex = atom.latex ? atom.latex.trim() : '' ;
                    if (trimLatex === '\\sum') {
                        if (atom.superscript &amp;&amp; atom.subscript) {
                            let sup = MathAtom.toSpeakableFragment(atom.superscript, options);
                            sup = sup.trim();
                            let sub = MathAtom.toSpeakableFragment(atom.subscript, options);
                            sub = sub.trim();
                            result += ' the summation from &lt;break time="200ms"/>' + sub + '&lt;break time="200ms"/> to  &lt;break time="200ms"/>' + sup + '&lt;break time="200ms"/> of &lt;break time="150ms"/>';
                            supsubHandled = true;
                    } else if (atom.subscript) {
                            let sub = MathAtom.toSpeakableFragment(atom.subscript, options);
                            sub = sub.trim();
                            result += ' the summation from &lt;break time="200ms"/>' + sub + '&lt;break time="200ms"/> of &lt;break time="150ms"/>';
                            supsubHandled = true;
                        } else {
                            result += ' the summation of';
                        }
                    } else if (trimLatex === '\\prod') {
                        if (atom.superscript &amp;&amp; atom.subscript) {
                            let sup = MathAtom.toSpeakableFragment(atom.superscript, options);
                            sup = sup.trim();
                            let sub = MathAtom.toSpeakableFragment(atom.subscript, options);
                            sub = sub.trim();
                            result += ' the product from &lt;break time="200ms"/>' + sub + '&lt;break time="200ms"/> to &lt;break time="200ms"/>' + sup + '&lt;break time="200ms"/> of &lt;break time="150ms"/>';
                            supsubHandled = true;
                        } else if (atom.subscript) {
                            let sub = MathAtom.toSpeakableFragment(atom.subscript, options);
                            sub = sub.trim();
                            result += ' the product from &lt;break time="200ms"/>' + sub + '&lt;break time="200ms"/> of &lt;break time="150ms"/>';
                            supsubHandled = true;
                        } else {
                            result += ' the product  of ';
                        }
                    } else if (trimLatex === '\\int') {
                        if (atom.superscript &amp;&amp; atom.subscript) {
                            let sup = MathAtom.toSpeakableFragment(atom.superscript, options);
                            sup = sup.trim();
                            let sub = MathAtom.toSpeakableFragment(atom.subscript, options);
                            sub = sub.trim();
                            result += ' the integral from &lt;break time="200ms"/>' + emph(sub) + '&lt;break time="200ms"/> to &lt;break time="200ms"/>' + emph(sup) + ' &lt;break time="200ms"/> of ';
                            supsubHandled = true;
                        } else {
                            result += ' the integral of &lt;break time="200ms"/> ';
                        }
                    } else if (typeof atom.body === 'string') {
                        const value = PRONUNCIATION[atom.body] ||
                            PRONUNCIATION[atom.latex.trim()];
                        if (value) {
                            result += value;
                        } else {
                            result += ' ' + atom.body;
                        }
                    } else if (atom.latex &amp;&amp; atom.latex.length > 0) {
                        if (atom.latex[0] === '\\') {
                            result += ' ' + atom.latex.substr(1);
                        } else {
                            result += ' ' + atom.latex;
                        }
                    }
                }
                break;
            case 'font':
                options.speechMode = 'text';
                result += '&lt;break time="200ms"/>';
                result += MathAtom.toSpeakableFragment(atom.body, options);
                result += '&lt;break time="200ms"/>';
                options.speechMode = 'math';
                break;

            case 'enclose':
                body = MathAtom.toSpeakableFragment(atom.body, options);

                if (isAtomic(atom.body)) {
                    result += ' crossed out ' + body + ' , ';
                } else {
                    result += ' crossed out ' + body + '. End cross out';
                }
                break;

            case 'space':
            case 'spacing':
            case 'color':
            case 'sizing':
            case 'mathstyle':
            case 'box':
                // @todo
                break;

        }
        if (!supsubHandled &amp;&amp; atom.superscript) {

            let sup = MathAtom.toSpeakableFragment(atom.superscript, options);
            sup = sup.trim();
            const sup2 = sup.replace(/&lt;[^>]*>/g, '');
            if (isAtomic(atom.superscript)) {
                if (options.speechMode === 'math') {
                    const id = atomicID(atom.superscript);
                    if (id) {
                        result += '&lt;mark name="' + id + '"/>';
                    }
                }
                if (sup2 === '\u2032') {
                    result += ' prime ';
                } else if (sup2 === '2') {
                    result += ' squared ';
                } else if (sup2 === '3') {
                    result += ' cubed ';
                } else if (isNaN(parseInt(sup2))) {
                    result += ' to the ' + sup + '; ';
                } else {
                    result += ' to the &lt;say-as interpret-as="ordinal">' + sup2 + '&lt;/say-as> power; ';
                }
            } else {
                if (isNaN(parseInt(sup2))) {
                    result += ' raised to the ' + sup + '; ';
                } else {
                    result += ' raised to the &lt;say-as interpret-as="ordinal">' + sup2 + '&lt;/say-as> power; ';
                }
            }
        }
        if (!supsubHandled &amp;&amp; atom.subscript) {
            let sub = MathAtom.toSpeakableFragment(atom.subscript, options);
            sub = sub.trim();
            if (isAtomic(atom.subscript)) {
                result += ' sub ' + sub;
            } else {
                result += ' subscript ' + sub + '. End subscript. ';
            }
        }
    }


    return result;
}


/**
 * @param {MathAtom[]}  [atoms] The atoms to represent as speakable text.
 * If omitted, `this` is used.
 * @param {Object.&lt;string, any>} [options]
*/
MathAtom.toSpeakableText = function(atoms, options) {
    if (!options) {
        options = {
            textToSpeechMarkup: '',     // no markup
            textToSpeechRules: 'mathlive'
        }
    }
    options.speechMode = 'math';

    if (window.sre &amp;&amp; options.textToSpeechRules === 'sre') {
        options.generateID = true;
        const mathML = MathAtom.toMathML(atoms, options);
        if (mathML) {
            if (options.textToSpeechMarkup) {
                options.textToSpeechRulesOptions = options.textToSpeechRulesOptions || {};
                options.textToSpeechRulesOptions.markup = options.textToSpeechMarkup;
                if (options.textToSpeechRulesOptions.markup === 'ssml') {
                    options.textToSpeechRulesOptions.markup = 'arno';
                }
                options.textToSpeechRulesOptions.rate = options.speechEngineRate;
            }
            if (options.textToSpeechRulesOptions) {
                window.sre.System.getInstance().setupEngine(options.textToSpeechRulesOptions);
            }
            return window.sre.System.getInstance().toSpeech(mathML);
        }
        return '';
        // return window.sre.toSpeech(MathAtom.toMathML(atoms));
    }

    let result = MathAtom.toSpeakableFragment(atoms, options);

    if (options.textToSpeechMarkup === 'ssml') {
        let prosody = '';
        if (options.speechEngineRate) {
            prosody = '&lt;prosody rate="' + options.speechEngineRate + '">'
        }
        result = `&lt;?xml version="1.0"?>&lt;speak version="1.1" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US">` +
        '&lt;amazon:auto-breaths>' +
        prosody +
        '&lt;p>&lt;s>' +
        result +
        '&lt;/s>&lt;/p>' +
        (prosody ? '&lt;/prosody>' : '') +
        '&lt;/amazon:auto-breaths>' +
        '&lt;/speak>';
    } else if (options.textToSpeechMarkup === 'mac' &amp;&amp; platform('mac') === 'mac') {
        // Convert SSML to Mac markup
        result = result.replace(/&lt;mark([^/]*)\/>/g, '')
            .replace(/&lt;emphasis>/g, '[[emph+]]')
            .replace(/&lt;\/emphasis>/g, '')
            .replace(/&lt;break time="([0-9]*)ms"\/>/g, '[[slc $1]]')
            .replace(/&lt;say-as[^>]*>/g, '')
            .replace(/&lt;\/say-as>/g, '');
    } else {
        // If no markup was requested, or 'mac' markup, but we're not on a mac,
        // remove any that we may have
        // Strip out the SSML markup
        result = result.replace(/&lt;[^>]*>/g, '')
                .replace(/\s{2,}/g, ' ');
    }
    return result;

}

// Export the public interface for this module
export default {}

</code></pre>
        </article>
    </section>




</main>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="scripts/namis.search.jquery.js"></script>
<script>
    function readCookie(a) {
        var b = document.cookie.match('(^|;)\\s*' + a + '\\s*=\\s*([^;]+)');
        return b ? b.pop() : '';
    }
    function writeCookie(a, v) {
		var date = new Date();
		date.setTime(date.getTime()+(30*24*60*60*1000));
    	document.cookie = a + "=" + v + "; expires=" + date.toUTCString() + "; path=/";
    }

    var cookie = readCookie('symbol-access');
    if (cookie === 'no-private') {
        document.documentElement.classList.add('no-private');
    }
    
   document.getElementById('toggle-private').checked = 
    !document.documentElement.classList.contains('no-private');


    prettyPrint();
    (function($){
        $('#nav').search(['className', 'methodName']);
    })(jQuery);
</script>
<script src="scripts/linenumber.js"></script>


    <script src="http://mathlive.io/sprint15/mathlive/mathlive.js"></script><script>if (MathLive) {MathLive.renderMathInDocument();}</script>


</body>
</html>
